{{ define "content" }}
<h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º–∏</h2>
<a href="/admin/cars/add" class="btn btn-success mb-3">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å</a>

<table class="table table-bordered table-striped">
    <thead>
    <tr>
        <th>ID</th>
        <th>–ú–∞—Ä–∫–∞</th>
        <th>–ú–æ–¥–µ–ª—å</th>
        <th>–ì–æ–¥</th>
        <th>–¶–µ–Ω–∞</th>
        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
    </tr>
    </thead>
    <tbody id="car-table"></tbody>
</table>

<script>
    async function loadAdminCars() {
        const res = await fetch("/api/cars", {
            headers: {
                "Authorization": "Bearer " + localStorage.getItem("token")
            }
        });
        const cars = await res.json();
        const table = document.getElementById("car-table");
        table.innerHTML = "";

        cars.forEach(car => {
            table.innerHTML += `
                <tr>
                    <td>${car.ID}</td>
                    <td>${car.brand}</td>
                    <td>${car.model}</td>
                    <td>${car.year}</td>
                    <td>$${car.price}</td>
                    <td>
                        <a href="/admin/cars/edit?id=${car.ID}" class="btn btn-sm btn-warning">‚úèÔ∏è</a>
                        <button onclick="deleteCar(${car.ID})" class="btn btn-sm btn-danger">üóëÔ∏è</button>
                    </td>
                </tr>
            `;
        });
    }

    async function deleteCar(id) {
        if (!confirm("–£–¥–∞–ª–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å?")) return;
        await fetch(`/api/cars/${id}`, {
            method: "DELETE",
            headers: {
                "Authorization": "Bearer " + localStorage.getItem("token")
            }
        });
        loadAdminCars();
    }

    loadAdminCars();
</script>
{{ end }}
